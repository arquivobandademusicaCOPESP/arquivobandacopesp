<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Arquivo da banda de mÃºsica do Comando de OperaÃ§Ãµes Especiais</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #2d2d2d;
      color: white;
      margin: 0;
      padding: 0;
    }

    header {
      background-color: #1b1b1b;
      padding: 20px;
      text-align: center;
      font-size: 22px;
      font-weight: bold;
      color: #9acd32;
    }

    #loader {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 100px;
    }

    #loader img {
      width: 64px;
      height: 64px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    #conteudo {
      padding: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      justify-content: center;
    }

    .folder {
      text-align: center;
      cursor: pointer;
      width: 120px;
    }

    .folder img {
      width: 80px;
      height: 80px;
    }

    .folder span {
      display: block;
      margin-top: 8px;
      font-weight: bold;
      color: white;
    }
  </style>
</head>
<body>
  <header>Arquivo da banda de mÃºsica do Comando de OperaÃ§Ãµes Especiais</header>

  <div id="loader">
    <img src="https://i.imgur.com/llF5iyg.gif" alt="Carregando...">
    <p>carregando... aguarde!</p>
  </div>

  <div id="conteudo" style="display: none;"></div>

  <script>
    const URL = "https://script.google.com/macros/s/AKfycby_jTo4pWLeGMn9eKcxA0jAVyfwS6xv8ZUroOFkNMyCRN1CBaqwIMTW-W3j0ViDC0rl/exec";

    function criarPastasPrincipais(data) {
      const conteudo = document.getElementById("conteudo");
      conteudo.innerHTML = '';

      for (const subpasta of data.subpastas) {
        const div = document.createElement("div");
        div.className = "folder";
        div.onclick = () => abrirSubpasta(subpasta.id, div);

        div.innerHTML = `
          <img src="https://cdn-icons-png.flaticon.com/512/716/716784.png" alt="Pasta">
          <span>${subpasta.nome}</span>
        `;

        conteudo.appendChild(div);
      }

      document.getElementById("loader").style.display = "none";
      conteudo.style.display = "flex";
    }

    function abrirSubpasta(id, div) {
      div.innerHTML += `<p style="color: yellow;">Carregando...</p>`;
      fetch(`${URL}?id=${id}`)
        .then(res => res.json())
        .then(data => {
          const ul = document.createElement("ul");
          data.arquivos.forEach(arq => {
            const li = document.createElement("li");
            li.innerHTML = `<a href="${arq.url}" target="_blank" style="color: lightblue;">ðŸ“„ ${arq.nome}</a>`;
            ul.appendChild(li);
          });
          div.appendChild(ul);
        })
        .catch(err => {
          div.innerHTML += `<p style="color:red;">Erro ao abrir pasta.</p>`;
          console.error(err);
        });
    }

    window.onload = () => {
      fetch(`${URL}?id=1kLcbguxmPRYCF2OVWcqQpN8dUQhcJv3U`)
        .then(res => res.json())
        .then(data => criarPastasPrincipais(data))
        .catch(err => {
          document.getElementById("loader").innerHTML = "<p>Erro ao carregar as pastas ðŸ˜¢</p>";
          console.error(err);
        });
    };
  </script>
<footer style="position: fixed; bottom: 10px; right: 20px; font-size: 0.9em; color: #ccc; text-align: right; line-height: 1.4;">
  <p style="margin: 0;">
    ResponsÃ¡veis:<br>
    2Âº SGT Cesar Augusto.<br>
    SD ProcÃ³pio.<br>
    SD Correia.
  </p>
</footer>


</body>
</html>
