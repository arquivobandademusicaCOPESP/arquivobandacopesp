<script>
  const URL = "https://script.google.com/macros/s/AKfycby_jTo4pWLeGMn9eKcxA0jAVyfwS6xv8ZUroOFkNMyCRN1CBaqwIMTW-W3j0ViDC0rl/exec";

  function criarHTML(pasta) {
    let html = `<div class="folder" data-id="${pasta.id}"><h3>üìÅ <a href="#" onclick="carregarPasta('${pasta.id}', this); return false;">${pasta.nome}</a></h3><ul>`;
    
    if (pasta.arquivos) {
      for (const arquivo of pasta.arquivos) {
        html += `<li><a href="${arquivo.url}" target="_blank">üìÑ ${arquivo.nome}</a></li>`;
      }
    }
    
    html += `</ul></div>`;
    return html;
  }

  function carregarPasta(id, link = null) {
    const destino = link ? link.closest('.folder') : document.getElementById("conteudo");

    fetch(`${URL}?id=${id}`)
      .then(res => res.json())
      .then(data => {
        const html = criarHTML(data);
        if (link) {
          // Se for uma subpasta, adiciona dentro da pasta clicada
          destino.innerHTML += html;
        } else {
          // Se for a primeira vez (pasta raiz), substitui tudo
          destino.innerHTML = html;
        }
      })
      .catch(err => {
        destino.innerHTML = "Erro ao carregar os arquivos üò¢";
        console.error(err);
      });
  }

  // Carregar a pasta raiz ao iniciar
  window.onload = () => carregarPasta("1kLcbguxmPRYCF2OVWcqQpN8dUQhcJv3U");
</script>
